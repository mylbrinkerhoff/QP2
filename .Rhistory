setwd("~/Documents/1_Projects/QP2")
load("~/Documents/1_Projects/QP2/.RData")
# custom theme for plotting
my.theme <- theme(axis.text = element_text(colour="black", size=25),
text = element_text(size=26),
title = element_text(size=29),
axis.title.x=  element_text(vjust=-0.45),
axis.title.y = element_text(vjust=.2),
axis.ticks = element_line(colour="black"),
axis.line = element_line(),
legend.position = c(.8,.9),
legend.background = element_rect(size=0.25,
linetype="solid",
color = "black"),
)
theme2 <- theme(axis.text = element_text(colour="black", size=25),
text = element_text(size=26),
title = element_text(size=29),
axis.title.x=  element_text(vjust=-0.45),
axis.title.y = element_text(vjust=.2),
axis.ticks = element_line(colour="black"),
axis.line = element_line(),
legend.background = element_rect(size=0.25,
linetype="solid",
color = "black"),
)
# Adding the csv/txt file.
# This is the file that is generated from VoiceSauce.
zapotecVS <- read.table("SLZTone.txt", header = T, sep = "\t")
zapotecRD <- read.table("RDZapotec.txt", header = T, sep = "\t")
zapotecVS$phonation <- factor(ifelse(grepl("modal", zapotecVS$Filename, ignore.case = T), "Modal",
ifelse(grepl("breathy", zapotecVS$Filename, ignore.case = T), "Breathy",
ifelse(grepl("checked", zapotecVS$Filename, ignore.case = T), "Checked", "Laryngealized"
)
)
), levels = c("Modal", "Breathy", "Checked", "Laryngealized"))
zapotecVS$tone <- ifelse(grepl("_H.mat", zapotecVS$Filename, ignore.case = F), "H",
ifelse(grepl("_M.mat", zapotecVS$Filename, ignore.case = F), "M",
ifelse(grepl("_L.mat", zapotecVS$Filename, ignore.case = F), "L",
ifelse(grepl("_HL.mat", zapotecVS$Filename, ignore.case = F), "HL",
ifelse(grepl("_MH.mat", zapotecVS$Filename, ignore.case = F), "MH", "N"
)
)
)
)
)
# RD
zapotecRD$phonation <- factor(ifelse(grepl("modal", zapotecRD$Filename, ignore.case = T), "Modal",
ifelse(grepl("breathy", zapotecRD$Filename, ignore.case = T), "Breathy",
ifelse(grepl("checked", zapotecRD$Filename, ignore.case = T), "Checked", "Laryngealized"
)
)
), levels = c("Modal", "Breathy", "Checked", "Laryngealized"))
zapotecRD$tone <- ifelse(grepl("_H.mat", zapotecRD$Filename, ignore.case = F), "H",
ifelse(grepl("_M.mat", zapotecRD$Filename, ignore.case = F), "M",
ifelse(grepl("_L.mat", zapotecRD$Filename, ignore.case = F), "L",
ifelse(grepl("_HL.mat", zapotecRD$Filename, ignore.case = F), "HL",
ifelse(grepl("_MH.mat", zapotecRD$Filename, ignore.case = F), "MH", "N"
)
)
)
)
)
zapotecVS$Speaker <- rep("FSR")
zapotecRD$Speaker <- rep("RD")
zapotec.join <- bind_rows(list(zapotecRD,zapotecVS), .id = "id")
zapotec.join
# Two way table for tone and phonation
FSRtone_phonation <- table(zapotecVS$tone, zapotecVS$phonation)
FSRtone_phonation
RDtone_phonation <- table(zapotecRD$tone, zapotecRD$phonation)
RDtone_phonation
join.TP <- table(zapotec.join$tone, zapotec.join$phonation)
join.TP
# Normalize the scores for f0 in zapotec.join
zapotec.join$normalized_tone <- scale(zapotec.join$strF0)
# Normalize the scores for f0 in zapotec.join
zapotec.join$normalized_tone <- scale(zapotec.join$strF0, scale = c(0:5))
# Normalize the scores for f0 in zapotec.join
zapotec.join$normalized_tone <- scale(zapotec.join$strF0, scale = c(0,5))
# Normalize the scores for f0 in zapotec.join
zapotec.join$normalized_tone <- scale(zapotec.join$strF0)
# Normalize time
# takes in the data frame and adds a column for normalized time.
zapotec_timesFSR <- zapotecVS %>%
mutate(normalized_time = round((t_ms-seg_Start)/(seg_End-seg_Start),digits = 3))
zapotec_timesRD <- zapotecRD %>%
mutate(normalized_time = round((t_ms-seg_Start)/(seg_End-seg_Start),digits = 3))
zapotec_timesJoin <- zapotec.join %>%
mutate(normalized_time = round((t_ms-seg_Start)/(seg_End-seg_Start),digits = 3))
# Plotting the tone
# ggplot of normalized tone (y-axis) over time (x axis)
FSRtone_plot <- ggplot(data = zapotec_timesFSR,
aes(x = normalized_time,
y=strF0,
group=tone,
colour=tone,
fill=tone,
)) +
geom_smooth(method = "loess") +
scale_fill_manual(values=cbbPalette) + # To use for fills
scale_colour_manual(values=cbbPalette) + # To use for line and point colors
labs(title = "FSR's average F0 contours across tonal patterns",
x = "Normalized time (% of vowel duration)",
y = "F0 (Hz)",
colour = "Tonal Pattern") +
theme_bw() +
guides(colour = guide_legend("Tonal Pattern", ncol = 5),
fill = guide_legend("Tonal Pattern", ncol = 5) ) +
my.theme
print(FSRtone_plot)
ggsave(filename = "FSRTonePlot.png",
device = "png",
units = "in",
width=16,
height=9,
dpi=600)
RDtone_plot <- ggplot(data = zapotec_timesRD,
aes(x = normalized_time,
y=strF0,
group=tone,
colour=tone,
fill=tone,
)) +
geom_smooth(method = "loess") +
scale_fill_manual(values=cbbPalette) + # To use for fills
scale_colour_manual(values=cbbPalette) + # To use for line and point colors
labs(title = "RD's average F0 contours across tonal patterns",
x = "Normalized time (% of vowel duration)",
y = "F0 (Hz)",
colour = "Tonal Pattern") +
theme_bw() +
guides(colour = guide_legend("Tonal Pattern", ncol = 5),
fill = guide_legend("Tonal Pattern", ncol = 5) ) +
my.theme
print(RDtone_plot)
ggsave(filename = "RDTonePlot.png",
device = "png",
units = "in",
width=16,
height=9,
dpi=600)
Join.tone_plot <- ggplot(data = times.zapotec.join,
aes(x = normalized_time,
y = normalized_tone,
group=tone,
colour=tone,
fill=tone,
)) +
geom_smooth(method = "loess") +
scale_fill_manual(values=cbbPalette) + # To use for fills
scale_colour_manual(values=cbbPalette) + # To use for line and point colors
labs(title = "Normalized F0 contours across speakers",
x = "Normalized time (% of vowel duration)",
y = "Normalized F0 (z-score)",
colour = "Tonal Pattern") +
theme_bw() +
guides(colour = guide_legend("Tonal Pattern", ncol = 5),
fill = guide_legend("Tonal Pattern", ncol = 5) ) +
my.theme
print(Join.tone_plot)
ggsave(filename = "JoinTonePlot.png",
device = "png",
units = "in",
width=16,
height=9,
dpi=600)
# boxplot by phonation
FSRh1h2_boxplot <- ggplot(data = zapotec_timesFSR,
aes(x = phonation,
y=H1H2c,
group=interaction(tone, phonation),
colour=tone)
) +
geom_boxplot() +
labs(title = "FSR's average H1-H2 values across tone and phonation",
x = "Phonation",
y = "H1-H2 (dB)") +
theme_bw() +
guides(colour = guide_legend("Tonal Pattern", ncol = 5),
fill = guide_legend("Tonal Pattern", ncol = 5) ) +
my.theme
print(FSRh1h2_plot)
ggsave(filename = "FSRh1h2_box.png",
device = "png",
units = "in",
width=16,
height=9,
dpi=600)
# colorblind friendly colors
# The palette with grey:
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
## First
FSRFirst <- zapotec_timesFSR %>%
filter(normalized_time <= 0.249) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
normalized_time,
phonation,
tone
)
RDFirst <- zapotec_timesRD %>%
filter(normalized_time <= 0.249) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
normalized_time,
phonation,
tone
)
JointFirst <- zapotec_timesJoin %>%
filter(normalized_time <= 0.249) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
normalized_time,
phonation,
tone,
Speaker
)
## Second
FSRSecond <- zapotec_timesFSR %>%
filter(normalized_time >= 0.25 & normalized_time <= 0.499) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
normalized_time,
phonation,
tone
)
RDSecond <- zapotec_timesRD %>%
filter(normalized_time >= 0.25 & normalized_time <= 0.499) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
normalized_time,
phonation,
tone
)
JointSecond <- zapotec_timesJoin %>%
filter(normalized_time >= 0.25 & normalized_time <= 0.499) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
normalized_time,
phonation,
tone,
Speaker
)
FSRThird <- zapotec_timesFSR %>%
filter(normalized_time >= 0.500 & normalized_time <= 0.749) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
normalized_time,
phonation,
tone
)
RDThird <- zapotec_timesRD %>%
filter(normalized_time >= 0.500 & normalized_time <= 0.749) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
normalized_time,
phonation,
tone
)
JointThird <- zapotec_timesJoin %>%
filter(normalized_time >= 0.500 & normalized_time <= 0.749) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
normalized_time,
phonation,
tone,
Speaker
)
FSRFourth <- zapotec_timesFSR %>%
filter(normalized_time >= 0.750 & normalized_time <= 1.00) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
normalized_time,
phonation,
tone
)
RDFourth <- zapotec_timesRD %>%
filter(normalized_time >= 0.750 & normalized_time <= 1.00) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
normalized_time,
phonation,
tone
)
JointFourth <- zapotec_timesJoin %>%
filter(normalized_time >= 0.750 & normalized_time <= 1.00) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
normalized_time,
phonation,
tone,
Speaker
)
tone_results_1st <- lmer(strF0 ~ phonation + H1H2c + H1A3c + CPP + (1|Speaker) ,Joint_1)
Joint_1 <- zapotec_timesJoin %>%
filter(normalized_time >= 0 & normalized_time <= .329) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
strF0,
normalized_time,
phonation,
tone,
Speaker
)
Joint_2 <- zapotec_timesJoin %>%
filter(normalized_time >= 0.33 & normalized_time <= 0.659) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
strF0,
normalized_time,
phonation,
tone,
Speaker
)
Joint_3 <- zapotec_timesJoin %>%
filter(normalized_time >= 0.66 & normalized_time <= 1.00) %>%
select(H2Kc,
H1H2c,
H2H4c,
H1A1c,
H1A2c,
H1A3c,
H42Kc,
H2KH5Kc,
CPP,
Energy,
HNR05,
HNR15,
HNR25,
HNR35,
strF0,
normalized_time,
phonation,
tone,
Speaker
)
tone_results_1st <- lmer(strF0 ~ phonation + H1H2c + H1A3c + CPP + (1|Speaker) ,Joint_1)
summary(tone_results_1st)
tone_results_2nd <- lmer(strF0 ~ phonation + H1H2c + H1A3c + CPP + (1|Speaker) ,Joint_2)
summary(tone_results_2nd)
tone_results_3rd <- lmer(strF0 ~ phonation + H1H2c + H1A3c + CPP + (1|Speaker) ,Joint_3)
summary(tone_results_3rd)
